# ==============================================================================
# Comprehensive .htaccess file for a static HTML website
# ==============================================================================

# ------------------------------------------------------------------------------
# Rewrite Engine
# ------------------------------------------------------------------------------
# Turn on the rewrite engine for clean URLs and HTTPS redirection.
RewriteEngine On
RewriteBase /

# ------------------------------------------------------------------------------
# Force HTTPS (SSL)
# ------------------------------------------------------------------------------
# Redirect all HTTP traffic to the secure HTTPS version of the site.
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# ------------------------------------------------------------------------------
# Clean URLs (Remove .html extension)
# ------------------------------------------------------------------------------
# Rule 1: Redirects requests for file.html to /file
RewriteCond %{THE_REQUEST} \s/+(.+?)\.html[\s?] [NC]
RewriteRule ^ %1 [R=301,L]

# Rule 2: Internally rewrites /file back to file.html on the server
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_URI}.html -f
RewriteRule ^(.+?)/?$ $1.html [L]

# ------------------------------------------------------------------------------
# Default Pages and Error Documents
# ------------------------------------------------------------------------------
# Set the default file to load in a directory.
DirectoryIndex index.html

# Set custom error pages (optional, but good practice).
# Create these HTML files in your htdocs directory.
# ErrorDocument 404 /404.html
# ErrorDocument 403 /403.html

# ------------------------------------------------------------------------------
# Performance - Browser Caching (Leverage Browser Caching)
# ------------------------------------------------------------------------------
# Set expiration times for different file types.
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg           "access plus 1 year"
  ExpiresByType image/jpeg          "access plus 1 year"
  ExpiresByType image/gif           "access plus 1 year"
  ExpiresByType image/png           "access plus 1 year"
  ExpiresByType image/svg+xml       "access plus 1 year"
  ExpiresByType text/css            "access plus 1 month"
  ExpiresByType application/pdf     "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType application/x-javascript "access plus 1 month"
  ExpiresByType image/x-icon        "access plus 1 year"
</IfModule>

# ------------------------------------------------------------------------------
# Security Headers & Rules
# ------------------------------------------------------------------------------
# Deny access to sensitive files that should not be public.
<Files ".htaccess">
  Require all denied
</Files>
<Files "sitemap.xml">
  # This file should be public, so we don't block it.
  Require all granted
</Files>

# Set default character encoding to prevent character rendering issues.
AddDefaultCharset UTF-8
php_value date.timezone Indian/Maldives
ErrorDocument 400 https://errors.infinityfree.net/errors/404/
